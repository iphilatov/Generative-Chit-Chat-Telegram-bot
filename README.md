# Чатбот для проекта Generative Chit Chat

В данной директории представлены скрипты для тренировки, тестирования seq2seq модели для чат-бота и реализации бота в Telegram

## Quick start

### 1. Установите зависимости

`pip install -r requirements.txt`

NB! В файле лежат мои зависимости, отличные от тех, что лежали в репозитории.

### 2. Обучите модель

`python3 chatbot_train.py`

На GPU в Google Colab обучалось точно больше часа, поэтому этот этап в принципе можно пропустить, если вы готовы использовать обученную модель (ссылка ниже). Однако я рекомендую запустить эту команду, чтобы проверить корректность работы и автоматически создать директорию для файла с моделью.

Программа попросит дать ей путь до файла [*train.txt*](https://www.kaggle.com/c/chit-chat-encoders/data)

Обучение происходит на 1/40 корпуса.

### 3. Использование предобученной модели

В моем хранилище Google Drive можно найти уже [предобученную мною модель](https://drive.google.com/file/d/1EPH4f-9KdYGXeb0PSKYqsKI7InQv4g9a/view?usp=sharing) - она идентична той, что получится в процессе обучения.

Скаченный файл должен находится в директории *save/cb_model/qa/2-2_500* **вне** папки со скриптами.

### 4. Тестирование чат-бота

`python3 chatbot_test.py`

Этот код тоже справшивает путь до файла [***train.txt***](https://www.kaggle.com/c/chit-chat-encoders/data)

После того, как программа выведет *"Models built and ready to go!"*, можно спросить у нее что-нибудь.

### 5. Включение бота в Telegram

`python3 drive/MyDrive/philatov_chatbot/chatbot_tg.py`

(Не забудьте ввести путь до путь до файла [***train.txt***](https://www.kaggle.com/c/chit-chat-encoders/data) после включения команды)

Дождитесь вывода *"The bot is ready to work"* - теперь вы можете использовать [чат-бот в Telegram](https://t.me/DeepL_HW_Chatbot) (имя пользователя: **@DeepL_HW_Chatbot**).

### Примечания

Изначально все написано в Jupyter Notebook Google Colab'а, а затем распределено по отдельным файлам, однако из-за того, что это очень требовательная к ресурсам задача, я использовал Google Colab для тестирования скриптов. Это делается через "костыли" такие, как Google Drive и "!" в начале команды.

Как это все выглядит можно посмотреть в [моей тетрадке](https://colab.research.google.com/drive/1raqkxDEZazlBeNLHfg4nUy7LObnL844h?usp=sharing). Я не стал полностью прогонять ячейки в этом демострационном ноутбуке.

Если вы тоже хотите делать это через Google Colab, вы можете воспользоваться [файлами на моем Google Drive](https://drive.google.com/drive/folders/1kpsQheZH1kH3FDD7gZnkP_INgie8iPLp?usp=share_link). Они являются копиями файлов из этого репозитория, но с ними легче работать в Google Colab - просто сохраните их себе в хранилище в виде ярлыка.
